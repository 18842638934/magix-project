define("app/services/preservice",["magix"],function(e,n,i){var s=e("magix"),t=s.Service.extend(function(e,n){});s.mix(t,{serviceList:[],taskList:[],Actions:{login:function(e){console.log("login process"),setTimeout(e,1e4)},vcode:function(e){setTimeout(e,1e3)}},addService:function(e,n,i){t.serviceList.push({sync:e,bag:n,callback:i})},addTask:function(e){var n=t.taskList;1!=n[e]?(n[e]=1,n.push(e),t.runTask()):console.log(e," in list ,ignore")},runService:function(){var e=t.serviceList.shift();e&&(console.log("run waiting list",e),e.sync(e.bag,e.callback),t.runService())},runTask:function(){if(!t.$run){t.$run=!0;var e=t.taskList,n=e.shift();if(n){var i=t.Actions[n];i?i(function(){console.log(n+" end"),delete e[n],delete t.$run,t.runTask()}):(delete e[n],delete t.$run,t.runTask())}else delete t.$run,t.runService()}},intervene:function(){return t.$run}}),i.exports=t});