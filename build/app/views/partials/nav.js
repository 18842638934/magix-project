define("app/views/partials/nav",["magix","$","../../menu"],function(e,t,i){var a=e("magix"),s=e("$");a.applyStyle("p4b",'.p4b-5ca{background:#3e4048;width:100%;left:0;direction:rtl}.p4b-5ca,.p4b-1b0{height:100%;position:absolute;padding-top:40px;top:0;overflow:auto}.p4b-1b0{background:#31323d;width:200px;padding-bottom:42px;left:160px}.p4b-9d4{background-color:#3e4048;cursor:pointer;border-left:4px solid transparent;overflow:hidden;margin-bottom:14px;height:40px}.p4b-9d4:hover .p4b-5b9{color:hsla(0,0%,100%,.3)}.p4b-02d{opacity:.6}.p4b-1fd,.p4b-986{background:#32323d;border-left-color:#6364e5}.p4b-1fd .p4b-5b9,.p4b-986 .p4b-5b9{color:hsla(0,0%,100%,.3)}.p4b-1fd .p4b-c74:before,.p4b-986 .p4b-c74:before{content:"\\e789"}.p4b-5b9{display:block;float:left}.p4b-2eb{width:66px;font-size:14px;text-align:left;color:hsla(0,0%,100%,.45)}.p4b-530,.p4b-c74,.p4b-2eb{height:40px;line-height:40px;float:left}.p4b-530,.p4b-c74{color:hsla(0,0%,100%,.5)}.p4b-530{width:54px;text-align:left;padding-left:25px}.p4b-c74{width:36px;text-align:right;padding-right:15px}.p4b-c74:before{content:"\\e692"}.p4b-b63{padding:0 10px 0 20px}.p4b-0c3{float:right;width:40px;text-align:center}.p4b-dae,.p4b-0c3{height:40px;line-height:40px}.p4b-dae{color:#7f7f89;margin-bottom:4px}.p4b-d15{padding-left:10px}.p4b-b6e{display:block;padding:10px 0;color:#afafbc}.p4b-040,.p4b-b6e:active,.p4b-b6e:focus,.p4b-b6e:hover{color:#8787ea}.p4b-040 .p4b-485,.p4b-b6e:active .p4b-485,.p4b-b6e:focus .p4b-485,.p4b-b6e:hover .p4b-485{color:#8b8bed}.p4b-485{color:#a1a1b2;float:left;width:20px;margin-top:3px}.p4b-0df{display:block;margin-left:20px}.p4b-508{width:50px}.p4b-508 .p4b-c74,.p4b-508 .p4b-2eb{display:none}.p4b-508 .p4b-530{width:46px;padding-left:0;text-align:center}.p4b-508 .p4b-1b0{left:50px}');var p=e("../../menu"),n=p.menu(),d=n.menus,o=n.urlsToMainMap,r=n.subsMap,b=n.menusMap,l={triangle:{m:{x:-1,y:-1},n:{x:-1,y:0},p:{x:-1,y:-1}},getVirtualCoordinate:function(e){var t=this,i=t.$node.offset();return{x:e.pageX-i.left,y:t.$node.outerHeight()-(e.pageY-i.top)}},update:function(e){var t=this,i=t.triangle;t.$node=e;var a=e.outerWidth();i.m.x=a,i.m.y=e.outerHeight(),i.n.x=a},updatePoint:function(e){var t=this;t.triangle.p=t.getVirtualCoordinate(e)},isInTriangle:function(e){var t=this,i=t.getVirtualCoordinate(e),a=t.triangle;return i.x>a.m.x||i.x>=a.p.x&&(i.y>=a.p.y&&(a.m.y-i.y)/(a.m.x-i.x)>=(a.m.y-a.p.y)/(a.m.x-a.p.x)||i.y<a.p.y&&(a.n.y-i.y)/(a.n.x-i.x)<(a.n.y-a.p.y)/(a.n.x-a.p.x))}};i.exports=a.View.extend({tmpl:{html:'<div mx-guid="g1" class="p4b-5ca p16-3d3" mx-mouseout="hideSubs()" mx-mouseover="stopHide()" id="main_<%=$$.viewId%>" mx-contextmenu="preventHide()"><ul mx-guid="g0">2</ul></div><div mx-guid="g3" class="p16-3d3 p16-d72 p4b-1b0<%if(!$$.showSub){%> p16-ab9<%}%>" id="subs_<%=$$.viewId%>" mx-mouseout="hideSubs()" mx-mouseover="stopHide()" mx-contextmenu="preventHide()">3</div>',subs:[{s:"2",keys:["menus"],tmpl:'<li class="p4b-9d4 p16-c8d" data-key="index" mx-mouseover="startShowSubs()" mx-mousemove="showSubs()"><a class="p4b-5b9 p16-c8d" href="#!/index" hidefocus="true"><span class="p4b-530 pce-334">&#xe69c;</span><span class="p4b-2eb">首页</span></a></li><%for(var a=0,b;a<$$.menus.length;a++){b=$$.menus[a]%><li class="p4b-9d4 p16-c8d" data-key="<%=b.key%>" mx-mouseover="startShowSubs({key:\'<%=b.key%>\'})" mx-mousemove="showSubs({key:\'<%=b.key%>\'})"><a class="p4b-5b9" href="#!<%=b.url%>" hidefocus="true"><span class="p4b-530 pce-334"><%!b.icon%></span><span class="p4b-2eb"><%=b.text%></span></a><span class="p4b-c74 pce-334"></span></li><%}%>',path:'ul[mx-guid="g0"]'},{keys:["viewId"],path:'div[mx-guid="g1"]',attr:'id="main_<%=$$.viewId%>"',attrs:[{n:"id",p:1}]},{s:"3",keys:["showSub","viewId","subs"],tmpl:'<%if($$.subs){%><ul><%for(var c=0,d;c<$$.subs.length;c++){d=$$.subs[c];if(d.subs&&d.subs.length){%><li class="p4b-b63"><div class="p4b-dae p16-cp" <%if(d.canFolder){%> mx-click="toggleSubMenus({key:\'<%=d.key%>\'})" <%}%>><%=d.text%><%if(d.canFolder){%><i class="pce-334 p4b-0c3"><%if(d.folderExpand){%> &#xe786; <%}else{%> &#xe692; <%}%></i><%}%></div><ul class="p4b-d15" <%if(d.canFolder&&!d.folderExpand){%> style="display:none" <%}if(d.canFolder){%> data-toggle-menu="true" <%}%>><%for(var e=0,f;e<d.subs.length;e++){f=d.subs[e]%><li><a <%if(f.url){%>href="#!<%=f.url%>" <%}else{%>href="javascript:;" <%}%> class="p4b-b6e"><i class="pce-334 p4b-485"><%!f.icon%></i><span class="p4b-0df"><%=f.text%></span></a></li><%}%></ul></li><%}else{%><li class="p4b-b63"><a href="#!<%=d.url%>" class="p4b-b6e"><i class="pce-334 p4b-485" style="margin-right: 5px"><%!d.icon%></i><%=d.text%></a></li><%}}%></ul><%}%>',path:'div[mx-guid="g3"]',attr:'class="p16-3d3 p16-d72 p4b-1b0<%if(!$$.showSub){%> p16-ab9<%}%>" id="subs_<%=$$.viewId%>"',attrs:[{n:"class",p:1,f:"className"},{n:"id",p:1}],mask:"221"}]},init:function(){var e=this;a.Router.on("changed",function(){e.highlight(),e.highlightSub()})},render:function(){var e=this,t=s("#"+e.id);e.$node=t,e.updater.digest({viewId:e.id,menus:d}),e.$subs=s("#subs_"+e.id),l.update(e.$node),e.highlight()},highlight:function(){var e=a.Router.parse(),t=e.path;o[t]||(t=t.replace(/\-[^-]+$/,""));var i=o[t];"/index"==t&&(i="index");var p=this,n=s("#main_"+p.id);n.find("li").removeClass("p4b-986").removeClass("p4b-02d"),p.$mainMenu=n.find("[data-key="+i+"]").addClass("p4b-986"),p.$mainMenuKey=i},highlightSub:function(){var e=this,t=a.Router.parse(),i=t.path;o[i]||(i=i.replace(/\-[^-]+$/,"")),e.$subs.find("a").removeClass("p4b-040");var s=e.$subs.find('[href="#!'+i+'"]').addClass("p4b-040"),p=s.parents("ul");if("none"==p.css("display")){var n=p.prev("div[mx-click]");n.length&&n.trigger("click")}},toggleSubs:function(e,t,i){var a=this;i=e,e||(i="index"),i!=a.$mainMenuKey?a.$mainMenu.addClass("p4b-02d"):a.$mainMenu.removeClass("p4b-02d");var p=e+"?"+!!e;if(a.$flag!=p){if(a.$flag=p,a.$menu&&a.$menu.removeClass("p4b-1fd"),e&&a.$key!=e){a.$key=e;var n=b[e];a.updater.set({subs:n})}a.$menu=s(t).addClass("p4b-1fd"),a.updater.digest({showSub:!!e}),e&&a.highlightSub()}},hideSubs:function(e){var t=this;delete t.$preventHide;var i=function(){t.$menu&&(t.$menu.removeClass("p4b-1fd"),t.$mainMenu.removeClass("p4b-02d"),delete t.$menu),delete t.$flag,t.updater.digest({showSub:!1})};e?i():t.$hideTimer=setTimeout(i,100)},"startShowSubs<mouseover>":function(e){if(!a.inside(e.relatedTarget,e.eventTarget)){var t=this;l.updatePoint(e),clearTimeout(t.$showTimer);var i=e.eventTarget,s=e.params.key,p=t.updater.get("showSub");s&&!p?t.toggleSubs(s,i):t.$showTimer=setTimeout(function(){t.toggleSubs(s,i)},200)}},"stopHide<mouseover>":function(e){if(!a.inside(e.relatedTarget,e.eventTarget)){var t=this;clearTimeout(t.$hideTimer)}},"hideSubs<mouseout>":function(e){if(!a.inside(e.relatedTarget,e.eventTarget)){var t=this;if(t.$preventHide)return void delete t.$preventHide;clearTimeout(t.$showTimer),t.hideSubs()}},"toggleSubMenus<click>":function(e){var t=s(e.eventTarget),i=r[e.params.key];t.hasClass("iconfont")&&(t=t.parent());var a=t.next(),p=t.find(".iconfont");"none"==a.css("display")?(i.folderExpand=!0,a.slideDown(),p.html("&#xe786;")):(i.folderExpand=!1,a.slideUp(),p.html("&#xe692;"))},"showSubs<mousemove>":function(e){var t=this;l.isInTriangle(e)||t.toggleSubs(e.params.key,e.eventTarget)},"preventHide<contextmenu>":function(){var e=this;if(e.$preventHide=!0,!e.$listened){e.$listened=!0;var t=s(document),i=function(s){a.inside(s.target,e.id)||(delete e.$listened,t.off("mousemove mouseup",i),e.hideSubs(!0))};t.on("mousemove mouseup",i)}},"$doc<navslide>":function(){this.$node.toggleClass("p4b-508")},"$doc<navslidend>":function(){l.update(this.$node)},"$win<resize>":function(){l.update(this.$node)}})});