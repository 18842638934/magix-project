define("app/gallery/mx-tree/branch",["magix","$"],function(e,t,i){var p=e("magix"),d=e("$");i.exports=p.View.extend({tmpl:{html:'<ul mx-guid="g0">1</ul>',subs:[{s:"1",keys:["list","fromTop","dataId","textKey","id"],tmpl:'<%for(var a=0,b;a<$$.list.length;a++){b=$$.list[a]%><li class="p11-li<%if(!a&&$$.fromTop){%> p11-847<%}if(a==$$.list.length-1){%> p11-20b<%}%>"><div class="p11-a93<%if(b.children){%> p16-cp<%}%>" <%if(b.children){%> mx-click="toggle({id:\'<%=b[$$.dataId]%>\'})" <%}%>><%if(b.children){%><span class="p11-041">+</span><%}%></div><div class="p11-114"><label class="p11-p0"><input class="p16-fdc" type="checkbox" mx-change="check()" value="<%=b[$$.dataId]%>"/><%=b[$$.textKey]%></label></div><%if(b.children){%><div mx-view="app/gallery/mx-tree/branch?text=<%@$$.textKey%>&id=<%@$$.dataId%>&list=<%@b.children%>" id="<%=$$.id%>_<%=b[$$.dataId]%>" class="p11-719 p16-ab9" test="ab"></div><%}%></li><%}%>',path:'ul[mx-guid="g0"]'}]},init:function(e){var t=this;t.$list=e.list,t.$textKey=e.text,t.$dataId=e.id,t.$fromTop=e.fromTop},render:function(){var e=this;e.updater.digest({textKey:e.$textKey,id:e.id,fromTop:e.$fromTop,dataId:e.$dataId,list:e.$list})},checkAll:function(e){d("#"+this.id+' input[type="checkbox"]').prop("checked",e)},"toggle<click>":function(e){var t=d("#"+this.id+"_"+e.params.id),i=d(e.eventTarget).find("span");"+"==d.trim(i.html())?(t.slideDown(),i.html("-")):(t.slideUp(),i.html("+"))},"check<change>":function(e){var t=this,i=p.Vframe.get(t.id+"_"+e.eventTarget.value);i&&i.invoke("checkAll",[e.eventTarget.checked])}})}),define("app/gallery/mx-tree/index",["magix"],function(e,t,i){var p=e("magix"),d=function(e,t,i){if(!e._psrd){e._psrd=1,t=t||"id",i=i||"pId";for(var d={},a={},l=[],r=0,n=e.length;r<n;r++){var o=p.mix({},e[r]);if(d[o[t]]=o,a[o[t]]&&(o.children=a[o[t]]),o[i])if(d[o[i]]){var s=d[o[i]].children||(d[o[i]].children=[]);s.push(o)}else a[o[i]]?a[o[i]].push(o):a[o[i]]=[o];else l.push(o)}e.list=l,e.map=d}return e};p.applyStyle("p11",'.p11-719{padding-left:15px}.p11-li{line-height:22px;padding:0 4px;position:relative;border-left:1px solid #eee}.p11-li:before{content:"";position:absolute;border-top:1px solid #eee;width:12px;left:0;top:10px}.p11-a93{width:22px;height:22px;float:left;text-align:center;line-height:22px;font-weight:800;margin-left:-15px;margin-top:-2px;position:relative;z-index:2}.p11-041{display:inline-block;background-color:#fff;width:10px;height:10px;line-height:5px;border:1px solid #eee;font-size:11px}.p11-114{margin-left:10px}.p11-p0{padding:0}.p11-20b{border-left:none}.p11-20b:after{border-left:1px solid #eee;left:0;top:-2px}.p11-20b:after,.p11-847:after{content:"";position:absolute;width:1px;height:13px}.p11-847:after{border-left:1px solid #fff;top:-3px;left:-1px}'),i.exports=p.View.extend({tmpl:{html:'<div mx-guid="g0" id="tree_<%=$$.id%>"></div>',subs:[{keys:["id"],path:'div[mx-guid="g0"]',attr:'id="tree_<%=$$.id%>"',attrs:[{n:"id",p:1}]}]},init:function(e){this.$extra=e},render:function(){var e=this;e.updater.digest({id:e.id}),e.update(e.$extra)},update:function(e){var t=this,i=d(e.list,e.idKey,e.parentKey);t.$info=i,t.owner.mountVframe("tree_"+t.id,"app/gallery/mx-tree/branch",{id:e.id||"id",fromTop:!0,pId:e.parentKey,text:e.textKey,list:i.list})}})});