define("app/gallery/mx-tree/branch",["magix","$"],function(e,t,i){var d=e("magix"),a=e("$");i.exports=d.View.extend({tmpl:{html:'<ul mx-guid="g0">1</ul>',subs:[{s:"1",keys:["list","fromTop","dataId","textKey","id"],tmpl:'<%for(var i=0,br;i<$$.list.length;i++){br=$$.list[i]%><li class="pabcd11-li<%if(!i&&$$.fromTop){%> pabcd11-847<%}if(i==$$.list.length-1){%> pabcd11-20b<%}%>"><div class="pabcd11-a93<%if(br.children){%> pabcd16-cp<%}%>" <%if(br.children){%> mx-click="toggle({id:\'<%=br[$$.dataId]%>\'})" <%}%>><%if(br.children){%><span class="pabcd11-041">+</span><%}%></div><div class="pabcd11-114"><label class="pabcd11-p0"><input class="pabcd16-fdc" type="checkbox" mx-change="check()" value="<%=br[$$.dataId]%>"/><%=br[$$.textKey]%></label></div><%if(br.children){%><div mx-view="app/gallery/mx-tree/branch?text=<%@$$.textKey%>&id=<%@$$.dataId%>&list=<%@br.children%>" id="<%=$$.id%>_<%=br[$$.dataId]%>" class="pabcd11-719 pabcd16-ab9" test="ab"></div><%}%></li><%}%>',path:'ul[mx-guid="g0"]'}]},init:function(e){var t=this;t.$list=e.list,t.$textKey=e.text,t.$dataId=e.id,t.$fromTop=e.fromTop},render:function(){var e=this;e.updater.digest({textKey:e.$textKey,id:e.id,fromTop:e.$fromTop,dataId:e.$dataId,list:e.$list})},checkAll:function(e){a("#"+this.id+' input[type="checkbox"]').prop("checked",e)},"toggle<click>":function(e){var t=a("#"+this.id+"_"+e.params.id),i=a(e.eventTarget).find("span");"+"==a.trim(i.html())?(t.slideDown(),i.html("-")):(t.slideUp(),i.html("+"))},"check<change>":function(e){var t=this,i=d.Vframe.get(t.id+"_"+e.eventTarget.value);i&&i.invoke("checkAll",[e.eventTarget.checked])}})}),define("app/gallery/mx-tree/index",["magix"],function(e,t,i){var d=e("magix"),a=function(e,t,i){if(!e._psrd){e._psrd=1,t=t||"id",i=i||"pId";for(var a={},p={},r=[],l=0,n=e.length;l<n;l++){var c=d.mix({},e[l]);if(a[c[t]]=c,p[c[t]]&&(c.children=p[c[t]]),c[i])if(a[c[i]]){var o=a[c[i]].children||(a[c[i]].children=[]);o.push(c)}else p[c[i]]?p[c[i]].push(c):p[c[i]]=[c];else r.push(c)}e.list=r,e.map=a}return e};d.applyStyle("pabcd11",'.pabcd11-719{padding-left:15px}.pabcd11-li{line-height:22px;padding:0 4px;position:relative;border-left:1px solid #eee}.pabcd11-li:before{content:"";position:absolute;border-top:1px solid #eee;width:12px;left:0;top:10px}.pabcd11-a93{width:22px;height:22px;float:left;text-align:center;line-height:22px;font-weight:800;margin-left:-15px;margin-top:-2px;position:relative;z-index:2}.pabcd11-041{display:inline-block;background-color:#fff;width:10px;height:10px;line-height:5px;border:1px solid #eee;font-size:11px}.pabcd11-114{margin-left:10px}.pabcd11-p0{padding:0}.pabcd11-20b{border-left:none}.pabcd11-20b:after{border-left:1px solid #eee;left:0;top:-2px}.pabcd11-20b:after,.pabcd11-847:after{content:"";position:absolute;width:1px;height:13px}.pabcd11-847:after{border-left:1px solid #fff;top:-3px;left:-1px}'),i.exports=d.View.extend({tmpl:{html:'<div mx-guid="g0" id="tree_<%=$$.id%>"></div>',subs:[{keys:["id"],path:'div[mx-guid="g0"]',attr:'id="tree_<%=$$.id%>"',attrs:[{n:"id",p:1}]}]},init:function(e){this.$extra=e},render:function(){var e=this;e.updater.digest({id:e.id}),e.update(e.$extra)},update:function(e){var t=this,i=a(e.list,e.idKey,e.parentKey);t.$info=i,t.owner.mountVframe("tree_"+t.id,"app/gallery/mx-tree/branch",{id:e.id||"id",fromTop:!0,pId:e.parentKey,text:e.textKey,list:i.list})}})});