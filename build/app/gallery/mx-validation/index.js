define("app/gallery/mx-validation/index",["magix","$"],function(e,t,r){var a=e("magix"),n=e("$"),i=a.Vframe;a.applyStyle("pabcd70",".pabcd70-pr{position:relative}.pabcd70-ea5{border-color:#a62a22!important}.pabcd70-msg,.pabcd70-adf{display:none;line-height:18px;border-radius:4px;padding:4px 8px;position:absolute;background:#fff;white-space:nowrap;word-wrap:normal;z-index:1}.pabcd70-adf{line-height:22px;border:1px solid #e6e6e6}");var o=function(e){return e.replace(/[^\x00-\xff]/g,"xl").length},d=function(e){for(var t;e&&e!=document;){var r=e.id;if(r&&(t=i.get(r)))break;e=e.parentNode}return t},u=["required","number","length","blength","range","equalto","pattern"],s={required:function(e,t){return"true"!=t||n.trim(e)},number:function(e,t){return!(e=n.trim(e))||"true"!=t||e.indexOf(".")==e.lastIndexOf(".")&&/^[\d\.]+$/.test(e)},length:function(e,t){return t=n.parseJSON(t),!(e.length<t[0]||e.length>t[1])},blength:function(e,t){t=n.parseJSON(t);var r=o(e);return!(r<t[0]||r>t[1])},range:function(e,t){return t=n.parseJSON(t),!((e=parseFloat(e))<t[0]||e>t[1])},equalto:function(e,t){return n(t).val()==e},pattern:function(e,t){if(e=n.trim(e)){return new RegExp(t).test(e)}return!0}},f={required:function(){return"亲，此项必填哦～"},number:function(){return"亲，请输入数字哦～"},length:function(e){return e=n.parseJSON(e),"亲，此项长度不能小于"+e[0]+"，也不能大于"+e[1]+"哦～"},blength:function(e){return e=n.parseJSON(e),"亲，此项长度不能小于"+e[0]+"个字符，也不能大于"+e[1]+"个字符哦～"},range:function(e){return e=n.parseJSON(e),"亲，请输入"+e[0]+"-"+e[1]+"之间的数字哦～"},equalto:function(e){return"亲，请与"+e+"填写同样的内容～"},pattern:function(){return"亲，输入格式有误～"}},c={msg:function(e,t){var r=e.attr("id");r||(r=a.guid(),e.attr("id",r));var i=r+"_msg",o=n("#"+i);if(!t)return void o.hide();o.length||(e.wrap('<div class="pabcd16-ib" />'),e.parent().addClass("pabcd70-pr"),e.before('<div class="pabcd70-msg" id="'+i+'"/>'),o=n("#"+i)),o.html(t).show();var d,u=e.offset(),s=e.attr("validator-message-type"),f=u.top;if("outer"==s){o.addClass("pabcd70-adf");switch(e.attr("validator-message-placement")){case"top":d=u.left,f=u.top-e.outerHeight()-5;break;case"bottom":d=u.left,f=u.top+e.outerHeight()+5;break;default:d=u.left+e.outerWidth()+10}}else d=u.left-o.outerWidth()+e.outerWidth()-1,f+=3;var c=e.attr("validator-message-offset");c&&(c=n.parseJSON(c),d+=c[0],f+=c[1]),o.offset({left:d,top:f})},hideMsg:function(e){e=n(e);var t=e.attr("id");t||(t=a.guid(),e.attr("id",t)),n("#"+t+"_msg").hide()},ctrl:function(e,t){t?(e.addClass("pabcd70-ea5"),c.msg(e,e.attr("validator-"+t+"-message"))):(e.removeClass("pabcd70-ea5"),c.msg(e))}};r.exports=a.View.extend({one:function(e,t){e=n(e);var r=this,a=!1,i=e.data("owner");if(i||e.attr("data-owner",i=r.id),i==r.id){for(var o=0;o<u.length;o++){var d=u[o],l=e.attr("validator-"+d);if(l){var p=s[d];if(p&&!(p=p(t||e.val(),l))){a=d;var g=e.attr("validator-"+d+"-message");g||(g=f[d](l),e.attr("validator-"+d+"-message",g));break}}}c.ctrl(e,a)}return a},isValid:function(){var e=this,t=!0;return n("#"+e.id+" input,#"+e.id+" textarea,#"+e.id+" [mx-view],#"+e.id+" [validator]").each(function(r,a){var i=n(a);if(!i.data("owner")){var o=d(a.parentNode);o&&i.attr("data-owner",o.id)}e.one(a)&&(t=!1)}),t},'$div[class="pabcd70-msg"]<click>':function(e){var t=n(e.eventTarget);if("outer"!=t.attr("validator-message-type")){var r=e.eventTarget.id;(t=a.node(r.replace(/_msg$/,"")))&&"INPUT"==t.tagName&&(t.select(),t.focus())}},"$input,textarea,[mx-view]<keyup,change,focusin,focusout>":function(e){var t=this,r=e.eventTarget;e.verify||(clearTimeout(r.timer),e.verify=t.id,"focusin"==e.type?c.hideMsg(r):r.timer=setTimeout(t.wrapAsync(function(){t.one(r)}),20))}})});